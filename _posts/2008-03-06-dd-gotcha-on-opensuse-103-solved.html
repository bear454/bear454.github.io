---
layout: post
title: dd gotcha on openSUSE 10.3 - solved!
date: '2008-03-06T16:07:00.000-08:00'
author: James Mason
tags:
- Linux
- kiosk
- opensuse
modified_time: '2008-03-19T09:02:03.362-07:00'
blogger_id: tag:blogger.com,1999:blog-1724537071905135068.post-3216178387415263958
blogger_orig_url: http://bear454.blogspot.com/2008/03/dd-gotcha-on-opensuse-103-solved.html
---

Among other things, I'm responsible for a few kiosk workstations, which needed some attention.  They had been running openSUSE Linux 10.1, with KDE 3.5, using KDE's Kiosktool to lock things down, but since I'm moving to Gnome, I thought I should bring them along.  So I grabbed one machine, and installed openSUSE 10.3, and started to learn:<br /><ul><li> There are some very helpful gconf settings - run gconf-editor and search for 'lockdown'</li><br /><li>Firefox plugins - I am able to <a href="https://addons.mozilla.org/en-US/firefox/addon/4351">prevent add-ons from being modified, about:config from being accessed</a>, and <a href="https://addons.mozilla.org/en-US/firefox/addon/710">I took 'preferences' off the menu</a>.  Finally - all my users have the same browser.</li><br /><li>gdm scripts - I found a small script to tar up a user account, and when the (kiosk) user logs in it untars the home back to a pristine state.</li><br /></ul><a href="http://users.telenet.be/mydotcom/howto/linuxkiosk/ubuntu01.htm">Kiosk Linux: Ubuntu</a> was an extremely helpful document.<br /><br />The last stumbling block was some leftover cruft in /tmp, so I added a line to the user-home-fixer-upper script to clear anything from /tmp related to the kioskuser, and viola, a relatively un-muckable desktop.<br /><br />So I put the machine back out, and let it marinate in user sauce for a week, and the only thing that had changed was the volume (I'll figure that out eventually).  So I called it good, and created an image of the drive to copy to the other systems:<br /><ul><li>I plugged in my handy USB drive (labeled Phasmatis ex Machina, from the tool I used before dd ) and did "dd if=/dev/sda ibs=4096 conv=noerror | gzip > kioskimage.dd.gz", then unplugged it (I <span style="font-style: italic;">love</span> that I can do that on a live system).</li><li>I booted the next system with a rescue cd, plugged in <span style="font-style: italic;">Phasmatis</span> and "gunzip -c driveimage.dd.gz | dd of=/dev/sda".  Reboot, done... or so I thought.</li></ul>Although grub came up fine, and via the rescue system all was good, the system wouldn't boot. <blockquote><span style="font-size:100%;">"Waiting for device /dev/disk/by-id/scsi-SATA_ST340015A_5LA83RY9-part2 to appear: .............. Could not find"</span></blockquote>After a bit of stumbling around with Google, and the help of countd on #opensuse at freenode, I nailed down the problem:<br /><ul><li>/boot/grub/menu.lst was using the drive-id instead of the old-school partition device (/dev/sda).</li><li>ditto for /etc/fstab .</li></ul>So I changed those files to use /dev/sdaN instead of /dev/disk/by-id/....partN and <span style="font-weight: bold;">bam; </span>a working copy.<br /><br />Thanks to opengecko for his <a href="http://opengecko.wordpress.com/2008/02/21/ghostimage-your-suse-installation-with-dd/">excellent post</a>, which summarizes my path to clonedom.